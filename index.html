<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>การคำนวณเงินปันผล</title>
    <style>
        body  {
            font-family: 'Kanit', sans-serif, padding-top: 5cm ;
            background-color: #f0f8ff;
            margin: 20px;
            color: #1a237e;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1a237e;
            text-align: center;
        }
        table {
            width: 100%;
            margin: 20px 0;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #00008b;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #00008b;
            color: white;
        }
        .total-row {
            font-weight: bold;
        }
        input[type="number"] {
            width: 60%;
            padding: 5px;
            border-radius: 4px;
            border: 1px solid #ddd;
            box-sizing: border-box;
            font-size: 14px;
        }
        label {
            font-size: 16px;
            margin-right: 10px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>คำนวณเงินปันผลสหกรณ์</h1>

        <label for="dividendRate">อัตราการจ่ายปันผล (%): </label>
        <input type="number" id="dividendRate" value="-" step="0.01" oninput="calculateDividend()"> %
        <br><br>

        <table>
            <tr>
                <th>เดือน</th>
                <th>ส่งหุ้นแต่ละเดือน (บาท)</th>
                <th>ยอดรวม (บาท)</th>
                <th>เงินปันผล (บาท)</th>
                <th>ปันผลสะสม (บาท)</th>
            </tr>
            <tbody id="paymentTable">
                <tr>
                    <td>ยอดหุ้นยกมาต้นปี<br>(31 มีนาคม)</td>
                    <td><input type="number" id="carryover" oninput="calculateDividend()"></td>
                    <td id="totalCarryover">0</td>
                    <td id="dividendCarryover">0</td>
                    <td id="cumulativeCarryover">0</td>
                </tr>
                <tr>
                    <td>เมษายน</td>
                    <td><input type="number" id="month1" oninput="calculateDividend()"></td>
                    <td id="total1">0</td>
                    <td id="dividend1">0</td>
                    <td id="cumulative1">0</td>
                </tr>
                <tr>
                    <td>พฤษภาคม</td>
                    <td><input type="number" id="month2" oninput="calculateDividend()"></td>
                    <td id="total2">0</td>
                    <td id="dividend2">0</td>
                    <td id="cumulative2">0</td>
                </tr>
                <tr>
                    <td>มิถุนายน</td>
                    <td><input type="number" id="month3" oninput="calculateDividend()"></td>
                    <td id="total3">0</td>
                    <td id="dividend3">0</td>
                    <td id="cumulative3">0</td>
                </tr>
                <tr>
                    <td>กรกฎาคม</td>
                    <td><input type="number" id="month4" oninput="calculateDividend()"></td>
                    <td id="total4">0</td>
                    <td id="dividend4">0</td>
                    <td id="cumulative4">0</td>
                </tr>
                <tr>
                    <td>สิงหาคม</td>
                    <td><input type="number" id="month5" oninput="calculateDividend()"></td>
                    <td id="total5">0</td>
                    <td id="dividend5">0</td>
                    <td id="cumulative5">0</td>
                </tr>
                <tr>
                    <td>กันยายน</td>
                    <td><input type="number" id="month6" oninput="calculateDividend()"></td>
                    <td id="total6">0</td>
                    <td id="dividend6">0</td>
                    <td id="cumulative6">0</td>
                </tr>
                <tr>
                    <td>ตุลาคม</td>
                    <td><input type="number" id="month7" oninput="calculateDividend()"></td>
                    <td id="total7">0</td>
                    <td id="dividend7">0</td>
                    <td id="cumulative7">0</td>
                </tr>
                <tr>
                    <td>พฤศจิกายน</td>
                    <td><input type="number" id="month8" oninput="calculateDividend()"></td>
                    <td id="total8">0</td>
                    <td id="dividend8">0</td>
                    <td id="cumulative8">0</td>
                </tr>
                <tr>
                    <td>ธันวาคม</td>
                    <td><input type="number" id="month9" oninput="calculateDividend()"></td>
                    <td id="total9">0</td>
                    <td id="dividend9">0</td>
                    <td id="cumulative9">0</td>
                </tr>
                <tr>
                    <td>มกราคม</td>
                    <td><input type="number" id="month10" oninput="calculateDividend()"></td>
                    <td id="total10">0</td>
                    <td id="dividend10">0</td>
                    <td id="cumulative10">0</td>
                </tr>
                <tr>
                    <td>กุมภาพันธ์</td>
                    <td><input type="number" id="month11" oninput="calculateDividend()"></td>
                    <td id="total11">0</td>
                    <td id="dividend11">0</td>
                    <td id="cumulative11">0</td>
                </tr>
                <tr>
                    <td>มีนาคม</td>
                    <td><input type="number" id="month12" oninput="calculateDividend()"></td>
                    <td id="total12">0</td>
                    <td id="dividend12">-</td>
                    <td id="cumulative12">0</td>
                </tr>
                <tr class="total-row">
                    <td>รวม</td>
                    <td></td>
                    <td id="totalAll">0</td>
                    <td id="">-</td>
                    <td id="cumulativeAll">0</td>
                </tr>
            </tbody>
        </table>

    </div>

    <script>
        const daysInYear = 365;
        const dividendRateElement = document.getElementById('dividendRate');

        // วันที่หุ้นถูกถือ (เริ่มต้นจากเมษายน ถึงมีนาคม)
        const daysInMonth = {
            1: 336,   // เมษายน
            2: 305,   // พฤษภาคม
            3: 275,   // มิถุนายน
            4: 244,   // กรกฎาคม
            5: 213,   // สิงหาคม
            6: 183,   // กันยายน
            7: 152,   // ตุลาคม
            8: 122,   // พฤศจิกายน
            9: 91,   // ธันวาคม
            10: 60,  // มกราคม
            11: 31,  // กุมภาพันธ์
            12: 0     // มีนาคม ไม่มีเงินปันผล
        };

        function calculateDividend() {
    const dividendRate = parseFloat(dividendRateElement.value) / 100; // อัตราปันผล
    let totalSum = 0;
    let cumulativeSum = 0;
      
    const carryoverAmount = parseFloat(document.getElementById('carryover').value) || 0; // ยอดหุ้นยกมาต้นปี

    // คำนวณเงินปันผลสำหรับยอดหุ้นยกมาต้นปี
    const carryoverDividend = carryoverAmount * dividendRate;
    cumulativeSum += carryoverDividend;

    // แสดงยอดหุ้นยกมาต้นปี
    document.getElementById('dividendCarryover').textContent = carryoverDividend.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    document.getElementById('totalCarryover').textContent = carryoverAmount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    document.getElementById('cumulativeCarryover').textContent = cumulativeSum.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });

    // คำนวณเงินปันผลสำหรับแต่ละเดือน
    for (let month = 1; month <= 12; month++) {
        const monthAmount = parseFloat(document.getElementById(`month${month}`).value) || 0;
        let dividend = 0;

        if (month !== 12) { // เดือนมีนาคมไม่คำนวณเงินปันผล
            const daysHeld = daysInMonth[month];
            dividend = (monthAmount * dividendRate * daysHeld) / daysInYear; // คำนวณเงินปันผลตามจำนวนวัน
        }

        // คำนวณยอดรวมและสะสม
        const previousTotal = month === 1 ? carryoverAmount : parseFloat(document.getElementById(`total${month - 1}`).textContent.replace(/,/g, '')) || 0; // เริ่มจากยอดหุ้นยกมาต้นปีในเดือนแรก
        const totalForMonth = previousTotal + monthAmount;
        cumulativeSum += dividend;

        // อัปเดตข้อมูล
        document.getElementById(`total${month}`).textContent = totalForMonth.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        document.getElementById(`dividend${month}`).textContent = month === 12 ? '-' : dividend.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        document.getElementById(`cumulative${month}`).textContent = cumulativeSum.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });

        totalSum += monthAmount;
    }

    // อัปเดตค่ารวม
    const totalWithCarryover = totalSum + carryoverAmount; // รวมยอดทั้งหมดที่มี "ยอดหุ้นยกมาต้นปี"
    document.getElementById('totalAll').textContent = totalWithCarryover.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }); // รวมยอดทั้งหมด
    document.getElementById('cumulativeAll').textContent = cumulativeSum.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

    </script>

</body>
</html>
